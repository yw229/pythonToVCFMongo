##################################################################
#
# Local Ancestry Inference for 1000 Genomes Project Phase I Admixed 
# samples
#
# 2012.06.04 - contact ekenny@stanford.edu 
#
# updated with corrections 2012.06.23
#
###########################################################################
#
# Data generated by the 1000 Genomes Project Admixture working group:
#
#	Simon Gravel, Brian Mapels, Fouad Zakharia, Eimear Kenny and 
#	Carlos Bustamante at Stanford Univeristy.
# 	Claire Churchhouse and Jonathan Marchini at Oxford University.
#	Anjali Gupta Hinch and Simon Myers at Oxford University.
# 	Amy Williams at Harvard University.
#	Yael Baran at Tel Aviv University.
#	Eran Halperin at Tel Aviv University and the International 
#	Computer Science Institute in Berkeley.  
#
##########################################################################

This README describes the local ancestry inference (LAI) tracts for 
phase I African-American (ASW, n=61), Mexican (MXL, n=66), Puerto Rican
(PUR, n=55) and Colombian (CLM, n=60) individuals available on the 1000
Genomes Project ftp site (this directory), how they were generated and
summary information. Files for each population are contained in zip files
(*_phase1_ancestry_deconvolution.zip), with a single bed file per
individual , i.e., PUR/HG00553.bed

A. The LAI calls are in tab-delimited *.bed format and each file has 5
columns:

Column 1: chromosome number [1-22]
Column 2: start position of tract hg19 (base 0)
Column 3: end position of tract hg19
Column 4: diploid ancestry call of tract* 
Column 5: length of tract in base pairs

*Diploid ancestry calls are a consensus of calls that agree in >= 3 of 
4 methods (LAMP-LD, HAPMIX, RFMIX and MULTIMIX - see section B below)

Dipoid ancestry tract code:
0 = unknown (a tie, 3-way or 4-way disagreement across methods)
1 = European:European
2 = European:African
3 = African:African
4 = European:Native American
5 = African:Native American
6 = Native American:Native American
undet = base pairs between the SNP at the end of one tract
and the first SNP at the beginning of the next tract. Regions 
at the start and end of each chromosome flanking the first and last 
SNPs used in the calling are also listed as 'undet'.

This directory also contains *_phase1_globalproportions_and_unknown.txt for 
each population. These files contain the proportion of each source
population (European, African or Native American) ancestry for each 
individual and the proportion called as 'unknown' averaged over all diploid
ancestry called tracts [0-6] (excluding 'undet' tracts). 

e.g. European Proportion = (sum[1] + ( (sum[2] + sum[4]) / 2) ) / sum[0-6] 

Column 1: 1000 Genomes Project individual identifier
Column 2: Proportion European ancestry
Column 3: Proportion African ancestry
Column 4: Proportion Native American ancestry*
Column 5: Proportion unknown ancestry

* Note: ASW LAI was trained with only European and African panels, Native 
American ancestry in these files is set to '0'. 

B. How the Diploid ancestry calls were generated

We compared four local ancestry inference (LAI) methods, LAMP-LD [1], 
HAPMIX [2], RFMIX [3] and MULTIMIX [4], based on discrete population 
approach exploiting allele frequency differences between several 
hypothesized ancestral or 'source' populations. For example, a Hispanic/
Latino individual may have a combination of European, African and Native 
American ancestry, and LAI methods trained with European, African and 
Native American reference panels may distinguish haplotypes or 'tracts'
along each chromosome that map to one of the source populations. We
generated these tracts using all four LAI methods for the admixed 1000
Genome Project populations in the following way:

1. Reference panels and admixed samples were phased with the SHAPEIT 
algorithm [5] using the children in the trios (Omni genotypes) for more 
accurate phasing where possible. 

2. LAI tracts were called for both haplotypes of each chromosome per 
individual using all four methods (four methods were run independently by 
each lab in the admixture working group) where all methods use the same
phased reference panels and admixed individuals. European or African tracts 
in the 1000 Genomes Project ASW populations were called by training LAI 
methods on 1000 Genomes Project European (n=397) and African (n=200) Omni
2.5M genotype data and calling tracts at ASW (n=61) Omni 2.5M sites. We did
not have a suitable Native American reference panel genotyped in the Omni 
2.5M chip so we used a reference panel from Mao et at [6] genotyped on
Affymetrix 6.0 platform (n=45). We generated an Affy6 genotype dataset 
by extracting Affymetrix 6.0 sites from a combination of 1000 Genomes
Project Omni 2.5M and low pass sequencing data from an interim June 2011
release for the European, African,MXL, CLM and PUR individuals, and called
European, African or Native American tracts for the MXL (n=66), PUR (n=55)
and CLM (n=60) populations at Affy 6.0 sites.

3. Calls for both haplotypes at each genotyped site (Affy 6.0 or Omni 2.5M) 
were collapsed to give single diploid call per site. This was done for all 
admixed individuals across all four method. Diploid calls were chosen to 
avoid errors in haploid calls due to phasing switch errors and because we 
could not perform trio phasing on variants discovered through sequencing 
and not included on the chips. 

4. Calls across four methods were compared at every site to generate the 
consensus calls. Where 3 or 4 of the methods agreed, the majority call was 
set as the consensus call, if there was a tie, 3- or 4-way disagreement 
between methods, the site was set to 'unknown'. 

5. Finally, sequential diploid calls were collapsed to give diploid call 
tracts of base pair length the distance between the first and last SNP in 
the tract. Base pairs between the SNP at the end of one tract and the first 
SNP at the beginning of the next tract were labeled 'under'. Regions at the 
start and end of each chromosome flanking the first and last SNP sites used 
in the calling are also listed as 'undet'.


[1] Y Baran, B Pasaniuc, S Sankararaman et al Fast and accurate inference of local 
ancestry in Latino populations Bioinformatics 28(10):1359-1367 (2012)
[2] AL Price, A Tandon, N Patterson et al Sensitive Detection of Chromosomal Segments
of Distinct Ancestry in Admixed Populations PLoS Genet 5(6): e1000519 (2009) *
[3] Mapels, Gravel, Zakharia, Kenny and Bustamante, unpublished (2012)**
[4] Churchhouse and Marchini, unpublished (2012) ***
[5] O Delaneau, J Marchini and J-F Zagury A linear complexity phasing method for 
thousands of genomes Nature Methods 9(2):179-81 (2011)
[6] X. Mao et al A genomewide admixture mapping panel for Hispanic/Latino 
populations. AJHG 80, 1171 (2007)

* A version of the HAPMIX method that was adapted to use 3 ancestral source 
populations was used for the MXL, CLM and PUR populations.
** RFMIX is a a discriminative model based on conditional random fields parameterized 
by random forests, using window sizes of 0.6 cM and assuming 10 generations since 
admixture.
*** MULTIMIX is a method that allows for any number of source populations, models
population linkage disequilibrium between markers and is applicable to datasets in 
which the sample and source populations are either phased or unphased. The model is 
based upon a hidden Markov model to model switches in ancestry between consecutive 
windows of loci

The Native American training data is also available from this ftp site

ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130711_native_american_admix_train/
